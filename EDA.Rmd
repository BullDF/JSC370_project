---
title: Exploratory Data Analysis
output: html_document
---

This page shows some plots created for exploratory purposes. The plots are interactive so you can hover over to see more specific information. Click [here](https://github.com/BullDF/billboard-songs-analysis-with-spotify/blob/main/EDA/report.pdf) for a written EDA report with analysis.

```{r echo=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  cache = TRUE
)
```

```{r}
library(plotly)
library(lubridate)
```

```{r}
source("https://raw.githubusercontent.com/BullDF/billboard-songs-analysis-with-spotify/website/data_wrangling.R")
tracks_with_genres <- read.csv("https://raw.githubusercontent.com/BullDF/billboard-songs-analysis-with-spotify/main/data/ml_analysis/tracks_with_genres.csv")
```

## Bar Charts for Features {.tabset}

### Modes

```{r}
p <- tracks |>
  count(mode) |>
  ggplot(aes(
    x = mode,
    y = n,
    fill = mode
  )) +
  geom_col() +
  labs(
    x = "Mode",
    y = "Frequency"
  ) +
  ggtitle("Count of Major vs. Minor Tracks") +
  theme_classic() +
  theme(legend.position = "none")
ggplotly(p, tooltip = "n")
```

### Top Words in Track Names

```{r}
p <- no_stopwords_top_20 |>
  rename(n = word_freq) |>
  ggplot(aes(
    x = reorder(word, n),
    y = n,
    fill = word
  )) +
  geom_col() +
  labs(
    x = "Word",
    y = "Frequency"
  ) +
  ggtitle("Top 20 Words in Track Names (Stopwords Removed)") +
  theme_classic() +
  theme(legend.position = "none") +
  coord_flip()
ggplotly(p, tooltip = "n")
```

### Artists

```{r}
p <- tracks_with_artists |>
  group_by(artist_name) |>
  summarize(n = n()) |>
  arrange(desc(n)) |>
  head(20) |>
  ggplot(aes(
    x = reorder(artist_name, n),
    y = n,
    fill = artist_name
  )) +
  geom_col() +
  coord_flip() +
  labs(
    x = "Artist",
    y = "Frequency"
  ) +
  ggtitle("Count of Artists on Billboard") +
  theme_classic() +
  theme(legend.position = "none")
ggplotly(p, tooltip = "n")
```

### Music Genres

```{r}
p <- tracks_with_genres |>
  count(genre) |>
  ggplot(aes(x = reorder(genre, -n), y = n, fill = genre)) +
  geom_col() +
  theme_classic() +
  theme(legend.position = "none") +
  ggtitle("Count of Music Genres") +
  labs(x = "Genre", y = "Frequency")
ggplotly(p, tooltip = "n")
```

## Histograms for Features {.tabset}

### Year

```{r}
p <- tracks |>
  ggplot(aes(x = year)) +
  geom_histogram(
    binwidth = 1,
    color = "black",
    fill = "#FF0000"
  ) +
  theme_classic() +
  labs(
    x = "Year",
    y = "Frequency"
  ) +
  ggtitle("Distribution of Tracks over Time")
ggplotly(p)
```

### Acousticness

```{r}
p <- tracks |>
  ggplot(aes(x = acousticness)) +
  geom_histogram(
    binwidth = 2,
    color = "black",
    fill = "#0000FF"
  ) +
  theme_classic() +
  labs(
    x = "Acousticness",
    y = "Frequency"
  ) +
  ggtitle("Distribution of Acousticness")
ggplotly(p)
```

### Danceability

```{r}
p <- tracks |>
  ggplot(aes(x = danceability)) +
  geom_histogram(
    binwidth = 2,
    color = "black",
    fill = "#00FF00"
  ) +
  theme_classic() +
  labs(
    x = "Danceability",
    y = "Frequency"
  ) +
  ggtitle("Distribution of Danceability")
ggplotly(p)
```

### Energy

```{r}
p <- tracks |>
  ggplot(aes(x = energy)) +
  geom_histogram(
    binwidth = 2,
    color = "black",
    fill = "#008080"
  ) +
  theme_classic() +
  labs(
    x = "Energy",
    y = "Frequency"
  ) +
  ggtitle("Distribution of Energy")
ggplotly(p)
```

### Instrumentalness

```{r}
p <- tracks |>
  ggplot(aes(x = instrumentalness)) +
  geom_histogram(
    binwidth = 2,
    color = "black",
    fill = "#FFFF00"
  ) +
  theme_classic() +
  labs(
    x = "Instrumentalness",
    y = "Frequency"
  ) +
  ggtitle("Distribution of Instrumentalness")
ggplotly(p)
```

### Liveness

```{r}
p <- tracks |>
  ggplot(aes(x = liveness)) +
  geom_histogram(
    binwidth = 2,
    color = "black",
    fill = "#800080"
  ) +
  theme_classic() +
  labs(
    x = "Liveness",
    y = "Frequency"
  ) +
  ggtitle("Distribution of Liveness")
ggplotly(p)
```

### Loudness

```{r}
p <- tracks |>
  ggplot(aes(x = loudness)) +
  geom_histogram(
    binwidth = 1,
    color = "black",
    fill = "#FFA500"
  ) +
  theme_classic() +
  labs(
    x = "Loudness",
    y = "Frequency"
  ) +
  ggtitle("Distribution of Loudness")
ggplotly(p)
```

### Speechiness

```{r}
p <- tracks |>
  ggplot(aes(x = speechiness)) +
  geom_histogram(
    binwidth = 2,
    color = "black",
    fill = "#FFC0CB"
  ) +
  theme_classic() +
  labs(
    x = "Speechiness",
    y = "Frequency"
  ) +
  ggtitle("Distribution of Speechiness")
ggplotly(p)
```

### Valence

```{r}
p <- tracks |>
  ggplot(aes(x = valence)) +
  geom_histogram(
    binwidth = 2,
    color = "black",
    fill = "#A52A2A"
  ) +
  theme_classic() +
  labs(
    x = "Valence",
    y = "Frequency"
  ) +
  ggtitle("Distribution of Valence")
ggplotly(p)
```

### Popularity

```{r}
p <- tracks |>
  ggplot(aes(x = popularity)) +
  geom_histogram(
    binwidth = 2,
    color = "black",
    fill = "#00FFFF"
  ) +
  theme_classic() +
  labs(
    x = "Popularity",
    y = "Frequency"
  ) +
  ggtitle("Distribution of Popularity")
ggplotly(p)
```

### Duration

```{r}
p <- tracks |>
  ggplot(aes(x = minute(duration) * 60 + second(duration))) +
  geom_histogram(
    binwidth = 40,
    color = "black",
    fill = "#FF00FF"
  ) +
  theme_classic() +
  labs(
    x = "Duration (sec)",
    y = "Frequency"
  ) +
  ggtitle("Distribution of Duration in Seconds")
ggplotly(p)
```

## Scatterplots for Features vs. Time {.tabset}

### Acousticness

```{r}
p <- tracks |>
  ggplot(aes(x = year, y = acousticness)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE, color = "#FF0000") +
  labs(
    x = "Year",
    y = "Acousticness"
  ) +
  ggtitle("Acousticness vs. Time") +
  theme_classic()
ggplotly(p)
```

### Danceability

```{r}
p <- tracks |>
  ggplot(aes(x = year, y = danceability)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE, color = "#0000FF") +
  labs(
    x = "Year",
    y = "Danceability"
  ) +
  ggtitle("Danceability vs. Time") +
  theme_classic()
ggplotly(p)
```

### Energy

```{r}
p <- tracks |>
  ggplot(aes(x = year, y = energy)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE, color = "#00FF00") +
  labs(
    x = "Year",
    y = "Energy"
  ) +
  ggtitle("Energy vs. Time") +
  theme_classic()
ggplotly(p)
```

### Instrumentalness

```{r}
p <- tracks |>
  ggplot(aes(x = year, y = instrumentalness)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE, color = "#FFFF00") +
  labs(
    x = "Year",
    y = "Instrumentalness"
  ) +
  ggtitle("Instrumentalness vs. Time") +
  theme_classic()
ggplotly(p)
```

### Liveness

```{r}
p <- tracks |>
  ggplot(aes(x = year, y = liveness)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE, color = "#800080") +
  labs(
    x = "Year",
    y = "Liveness"
  ) +
  ggtitle("Liveness vs. Time") +
  theme_classic()
ggplotly(p)
```

### Loudness

```{r}
p <- tracks |>
  ggplot(aes(x = year, y = loudness)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE, color = "#FFA500") +
  labs(
    x = "Year",
    y = "Loudness"
  ) +
  ggtitle("Loudness vs. Time") +
  theme_classic()
ggplotly(p)
```

### Speechiness

```{r}
p <- tracks |>
  ggplot(aes(x = year, y = speechiness)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE, color = "#FFC0CB") +
  labs(
    x = "Year",
    y = "Speechiness"
  ) +
  ggtitle("Speechiness vs. Time") +
  theme_classic()
ggplotly(p)
```

### Valence

```{r}
p <- tracks |>
  ggplot(aes(x = year, y = valence)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE, color = "#A52A2A") +
  labs(
    x = "Year",
    y = "Valence"
  ) +
  ggtitle("Valence vs. Time") +
  theme_classic()
ggplotly(p)
```

### Popularity

```{r}
p <- tracks |>
  ggplot(aes(x = year, y = popularity)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE, color = "#00FFFF") +
  labs(
    x = "Year",
    y = "Popularity"
  ) +
  ggtitle("Popularity vs. Time") +
  theme_classic()
ggplotly(p)
```

### Duration

```{r}
p <- tracks |>
  ggplot(aes(x = year, y = minute(duration) * 60 + second(duration))) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE, color = "#FF00FF") +
  labs(
    x = "Year",
    y = "Duration (sec)"
  ) +
  ggtitle("Duration in Seconds vs. Time") +
  theme_classic()
ggplotly(p)
```
